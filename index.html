<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friction-Zero OS</title>
    <!-- 파비콘: JavaScript를 통해 동적으로 변경될 예정 -->
    <link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🔵</text></svg>">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app-container">
        <!-- 긍정 확언 메시지 (숨겨진 상태) -->
        <div id="priming-overlay">
            <p id="priming-message"></p>
        </div>

        <!-- 로그인/회원가입 뷰 -->
        <section id="auth-view">
            <!-- 기존 로그인/회원가입 폼 -->
            <div class="auth-form__container">
                <form id="login-form" class="auth-form">
                    <h2>로그인</h2>
                    <div class="auth-form__field"><label for="login-email">이메일</label><input type="email" id="login-email" required></div>
                    <div class="auth-form__field"><label for="login-password">비밀번호</label><input type="password" id="login-password" required></div>
                    <p class="auth-form__error hidden"></p>
                    <button type="submit" class="button button--primary">로그인</button>
                    <p class="auth-form__switch">계정이 없으신가요? <button type="button" id="show-signup">회원가입</button></p>
                </form>
                <form id="signup-form" class="auth-form hidden">
                    <h2>회원가입</h2>
                    <div class="auth-form__field"><label for="signup-email">이메일</label><input type="email" id="signup-email" required></div>
                    <div class="auth-form__field"><label for="signup-password">비밀번호</label><input type="password" id="signup-password" required minlength="6"></div>
                    <p class="auth-form__error hidden"></p>
                    <button type="submit" class="button button--primary">회원가입</button>
                    <p class="auth-form__switch">이미 계정이 있으신가요? <button type="button" id="show-login">로그인</button></p>
                </form>
            </div>
        </section>

        <!-- 메인 앱 뷰 -->
        <main id="app-view" class="hidden">
            <header class="app-header">
                <div class="app-header__title">
                    <h1>Friction-Zero OS</h1>
                    <div class="gamification-stats">
                        <span>🔥 연속 <span id="streak-count">0</span>일</span>
                        <span class="separator">|</span>
                        <span>LV. <span id="user-level">1</span></span>
                    </div>
                </div>
                <div class="app-header__user-info">
                    <span id="user-email"></span>
                    <button id="logout-btn" class="button button--secondary">로그아웃</button>
                </div>
            </header>

            <!-- 컨디션 선택 화면 -->
            <section id="condition-selector">
                <h2>오늘의 컨디션은 어떠신가요?</h2>
                <div class="condition-selector__buttons">
                    <button class="button" data-condition="최상">최상</button>
                    <button class="button" data-condition="좋음">좋음</button>
                    <button class="button" data-condition="보통">보통</button>
                    <button class="button" data-condition="나쁨">나쁨</button>
                </div>
            </section>

            <!-- 타이머 화면 -->
            <section id="timer-view" class="hidden">
                <div id="daily-goal-progress" class="hidden">
                    <div class="progress-bar__container">
                        <div id="progress-bar" class="progress-bar__bar"></div>
                    </div>
                    <span id="goal-text"></span>
                </div>

                <div class="timer">
                    <div class="focus-counter" data-tooltip="오늘 획득한 집중 에너지">
                        <span id="focus-energy-display"></span>
                    </div>
                    <p class="timer__mode">집중</p>
                    <p class="timer__display">25:00</p>
                    <div class="timer__controls">
                        <button id="start-btn" class="button button--primary">시작</button>
                        <button id="pause-btn" class="button button--secondary">일시정지</button>
                        <button id="reset-btn" class="button">리셋</button>
                    </div>
                </div>

                <div class="settings">
                    <div class="settings__group">
                        <h3>뇌과학 프리셋</h3>
                        <div class="settings__presets">
                            <button class="button button--preset" data-focus="25" data-rest="5">25:05</button>
                            <button class="button button--preset" data-focus="50" data-rest="10">50:10</button>
                        </div>
                    </div>
                    <div class="settings__group">
                        <h3>알림 소리</h3>
                        <select id="alarm-sound-select" class="settings__select">
                            <option value="alarm_clock">알람시계</option>
                            <option value="digital_watch">디지털 시계</option>
                            <option value="bell">종소리</option>
                        </select>
                    </div>
                </div>
                
                <div class="main-actions">
                    <button id="forest-btn" class="button button--secondary">집중의 숲</button>
                    <button id="badges-btn" class="button button--secondary">나의 배지</button>
                    <button id="weekly-report-btn" class="button button--secondary">주간 회고</button>
                    <button id="end-day-btn" class="button button--primary">하루 마감</button>
                </div>
            </section>
        </main>
    </div>

    <!-- 모달 레이어 -->
    <div id="modal-layer">
        <!-- 일일 목표 설정 모달 -->
        <div id="goal-modal" class="modal">
            <div class="modal__overlay"></div>
            <div class="modal__content">
                <h2>오늘의 목표</h2>
                <p>오늘 몇 개의 집중 세션을 완료하시겠습니까?</p>
                <form id="goal-form">
                    <input type="number" id="goal-input" min="1" max="20" value="4" class="settings__input">
                    <button type="submit" class="button button--primary">목표 설정하고 시작</button>
                </form>
            </div>
        </div>
        
        <!-- 세션 전환 모달 -->
        <div id="session-transition-modal" class="modal">
            <div class="modal__overlay"></div>
            <div class="modal__content text-center">
                <h2 id="transition-title"></h2>
                <p id="transition-message"></p>
                <button id="next-session-btn" class="button button--primary"></button>
            </div>
        </div>

        <!-- 세션 기록 모달 -->
        <div id="log-modal" class="modal">
            <div class="modal__overlay" data-close-modal></div>
            <div class="modal__content">
                <button class="modal__close-btn" data-close-modal>&times;</button>
                <h2 id="log-modal-title">세션 기록</h2>
                <form id="log-form">
                    <!-- 기존 필드들 -->
                    <div class="form-field"><label for="log-activity">지난 시간 동안 무엇에 집중했나요?</label><textarea id="log-activity" rows="3" required></textarea></div>
                    <div class="form-field"><label>집중을 방해한 '마찰'이 있었나요?</label><div id="friction-tags" class="tag-group"></div></div>
                    <div class="form-field"><label>마찰 발생 시 느꼈던 감정은 무엇인가요?</label><div id="emotion-tags" class="tag-group"></div></div>
                    <div class="form-field"><label for="distraction-input">딴생각 저장소 (입력 후 Enter)</label><input type="text" id="distraction-input" placeholder="예: 저녁 장보기"><ul id="distraction-list"></ul></div>
                    <button type="submit" class="button button--primary">저장하고 계속하기</button>
                </form>
            </div>
        </div>
        
        <!-- 집중의 숲 모달 -->
        <div id="forest-modal" class="modal">
            <div class="modal__overlay" data-close-modal></div>
            <div class="modal__content">
                <button class="modal__close-btn" data-close-modal>&times;</button>
                <h2>나의 집중의 숲</h2>
                <p>뽀모도로는 씨앗을, 긴 집중은 나무를 심습니다.</p>
                <div id="forest-grid" class="forest-grid"></div>
            </div>
        </div>
        
        <!-- 배지 모달 -->
        <div id="badges-modal" class="modal">
            <div class="modal__overlay" data-close-modal></div>
            <div class="modal__content">
                <button class="modal__close-btn" data-close-modal>&times;</button>
                <h2>나의 배지</h2>
                <p>특정 마찰을 극복하거나 목표를 달성하면 배지를 얻습니다.</p>
                <div id="badges-container" class="badges-container"></div>
            </div>
        </div>

        <!-- 주간/일일 리포트 모달 (통합) -->
        <div id="report-modal" class="modal">
            <div class="modal__overlay" data-close-modal></div>
            <div class="modal__content">
                <button class="modal__close-btn" data-close-modal>&times;</button>
                <h2 id="report-modal-title">데일리 리포트</h2>
                <div id="report-content"></div>
                <button id="show-system-btn" class="button button--primary hidden">시스템 제작</button>
            </div>
        </div>
    </div>
    <script type="module" src="script.js"></script>
</body>
</html>

